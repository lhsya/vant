{"remainingRequest":"/Users/adamliu/works/vant/node_modules/babel-loader/lib/index.js!/Users/adamliu/works/vant/node_modules/vue-lazyload/vue-lazyload.js","dependencies":[{"path":"/Users/adamliu/works/vant/node_modules/vue-lazyload/vue-lazyload.js","mtime":1694509794524},{"path":"/Users/adamliu/works/vant/babel.config.js","mtime":1694509704583},{"path":"/Users/adamliu/works/vant/node_modules/cache-loader/dist/cjs.js","mtime":1694509793427},{"path":"/Users/adamliu/works/vant/node_modules/babel-loader/lib/index.js","mtime":1694509794381}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:LyohCiAqIFZ1ZS1MYXp5bG9hZC5qcyB2MS4yLjMKICogKGMpIDIwMTggQXdlIDxoaWxvbmdqd0BnbWFpbC5jb20+CiAqIFJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZS4KICovCiFmdW5jdGlvbiAoZSwgdCkgewogICJvYmplY3QiID09IHR5cGVvZiBleHBvcnRzICYmICJ1bmRlZmluZWQiICE9IHR5cGVvZiBtb2R1bGUgPyBtb2R1bGUuZXhwb3J0cyA9IHQoKSA6ICJmdW5jdGlvbiIgPT0gdHlwZW9mIGRlZmluZSAmJiBkZWZpbmUuYW1kID8gZGVmaW5lKHQpIDogZS5WdWVMYXp5bG9hZCA9IHQoKTsKfSh0aGlzLCBmdW5jdGlvbiAoKSB7CiAgInVzZSBzdHJpY3QiOwoKICBmdW5jdGlvbiBlKGUpIHsKICAgIHJldHVybiBlLmNvbnN0cnVjdG9yICYmICJmdW5jdGlvbiIgPT0gdHlwZW9mIGUuY29uc3RydWN0b3IuaXNCdWZmZXIgJiYgZS5jb25zdHJ1Y3Rvci5pc0J1ZmZlcihlKTsKICB9CiAgZnVuY3Rpb24gdChlKSB7CiAgICBlID0gZSB8fCB7fTsKICAgIHZhciB0ID0gYXJndW1lbnRzLmxlbmd0aCwKICAgICAgaSA9IDA7CiAgICBpZiAoMSA9PT0gdCkgcmV0dXJuIGU7CiAgICBmb3IgKDsgKytpIDwgdDspIHsKICAgICAgdmFyIG8gPSBhcmd1bWVudHNbaV07CiAgICAgIGcoZSkgJiYgKGUgPSBvKSwgcihvKSAmJiBuKGUsIG8pOwogICAgfQogICAgcmV0dXJuIGU7CiAgfQogIGZ1bmN0aW9uIG4oZSwgbikgewogICAgbShlLCBuKTsKICAgIGZvciAodmFyIG8gaW4gbikgaWYgKCJfX3Byb3RvX18iICE9PSBvICYmIGkobiwgbykpIHsKICAgICAgdmFyIGEgPSBuW29dOwogICAgICByKGEpID8gKCJ1bmRlZmluZWQiID09PSBMKGVbb10pICYmICJmdW5jdGlvbiIgPT09IEwoYSkgJiYgKGVbb10gPSBhKSwgZVtvXSA9IHQoZVtvXSB8fCB7fSwgYSkpIDogZVtvXSA9IGE7CiAgICB9CiAgICByZXR1cm4gZTsKICB9CiAgZnVuY3Rpb24gcihlKSB7CiAgICByZXR1cm4gIm9iamVjdCIgPT09IEwoZSkgfHwgImZ1bmN0aW9uIiA9PT0gTChlKTsKICB9CiAgZnVuY3Rpb24gaShlLCB0KSB7CiAgICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGUsIHQpOwogIH0KICBmdW5jdGlvbiBvKGUsIHQpIHsKICAgIGlmIChlLmxlbmd0aCkgewogICAgICB2YXIgbiA9IGUuaW5kZXhPZih0KTsKICAgICAgcmV0dXJuIG4gPiAtMSA/IGUuc3BsaWNlKG4sIDEpIDogdm9pZCAwOwogICAgfQogIH0KICBmdW5jdGlvbiBhKGUsIHQpIHsKICAgIGZvciAodmFyIG4gPSAhMSwgciA9IDAsIGkgPSBlLmxlbmd0aDsgciA8IGk7IHIrKykgaWYgKHQoZVtyXSkpIHsKICAgICAgbiA9ICEwOwogICAgICBicmVhazsKICAgIH0KICAgIHJldHVybiBuOwogIH0KICBmdW5jdGlvbiBzKGUsIHQpIHsKICAgIGlmICgiSU1HIiA9PT0gZS50YWdOYW1lICYmIGUuZ2V0QXR0cmlidXRlKCJkYXRhLXNyY3NldCIpKSB7CiAgICAgIHZhciBuID0gZS5nZXRBdHRyaWJ1dGUoImRhdGEtc3Jjc2V0IiksCiAgICAgICAgciA9IFtdLAogICAgICAgIGkgPSBlLnBhcmVudE5vZGUsCiAgICAgICAgbyA9IGkub2Zmc2V0V2lkdGggKiB0LAogICAgICAgIGEgPSB2b2lkIDAsCiAgICAgICAgcyA9IHZvaWQgMCwKICAgICAgICB1ID0gdm9pZCAwOwogICAgICBuID0gbi50cmltKCkuc3BsaXQoIiwiKSwgbi5tYXAoZnVuY3Rpb24gKGUpIHsKICAgICAgICBlID0gZS50cmltKCksIGEgPSBlLmxhc3RJbmRleE9mKCIgIiksIC0xID09PSBhID8gKHMgPSBlLCB1ID0gOTk5OTk4KSA6IChzID0gZS5zdWJzdHIoMCwgYSksIHUgPSBwYXJzZUludChlLnN1YnN0cihhICsgMSwgZS5sZW5ndGggLSBhIC0gMiksIDEwKSksIHIucHVzaChbdSwgc10pOwogICAgICB9KSwgci5zb3J0KGZ1bmN0aW9uIChlLCB0KSB7CiAgICAgICAgaWYgKGVbMF0gPCB0WzBdKSByZXR1cm4gLTE7CiAgICAgICAgaWYgKGVbMF0gPiB0WzBdKSByZXR1cm4gMTsKICAgICAgICBpZiAoZVswXSA9PT0gdFswXSkgewogICAgICAgICAgaWYgKC0xICE9PSB0WzFdLmluZGV4T2YoIi53ZWJwIiwgdFsxXS5sZW5ndGggLSA1KSkgcmV0dXJuIDE7CiAgICAgICAgICBpZiAoLTEgIT09IGVbMV0uaW5kZXhPZigiLndlYnAiLCBlWzFdLmxlbmd0aCAtIDUpKSByZXR1cm4gLTE7CiAgICAgICAgfQogICAgICAgIHJldHVybiAwOwogICAgICB9KTsKICAgICAgZm9yICh2YXIgbCA9ICIiLCBkID0gdm9pZCAwLCBjID0gci5sZW5ndGgsIGggPSAwOyBoIDwgYzsgaCsrKSBpZiAoZCA9IHJbaF0sIGRbMF0gPj0gbykgewogICAgICAgIGwgPSBkWzFdOwogICAgICAgIGJyZWFrOwogICAgICB9CiAgICAgIHJldHVybiBsOwogICAgfQogIH0KICBmdW5jdGlvbiB1KGUsIHQpIHsKICAgIGZvciAodmFyIG4gPSB2b2lkIDAsIHIgPSAwLCBpID0gZS5sZW5ndGg7IHIgPCBpOyByKyspIGlmICh0KGVbcl0pKSB7CiAgICAgIG4gPSBlW3JdOwogICAgICBicmVhazsKICAgIH0KICAgIHJldHVybiBuOwogIH0KICBmdW5jdGlvbiBsKCkgewogICAgaWYgKCFrKSByZXR1cm4gITE7CiAgICB2YXIgZSA9ICEwLAogICAgICB0ID0gZG9jdW1lbnQ7CiAgICB0cnkgewogICAgICB2YXIgbiA9IHQuY3JlYXRlRWxlbWVudCgib2JqZWN0Iik7CiAgICAgIG4udHlwZSA9ICJpbWFnZS93ZWJwIiwgbi5zdHlsZS52aXNpYmlsaXR5ID0gImhpZGRlbiIsIG4uaW5uZXJIVE1MID0gIiEiLCB0LmJvZHkuYXBwZW5kQ2hpbGQobiksIGUgPSAhbi5vZmZzZXRXaWR0aCwgdC5ib2R5LnJlbW92ZUNoaWxkKG4pOwogICAgfSBjYXRjaCAodCkgewogICAgICBlID0gITE7CiAgICB9CiAgICByZXR1cm4gZTsKICB9CiAgZnVuY3Rpb24gZChlLCB0KSB7CiAgICB2YXIgbiA9IG51bGwsCiAgICAgIHIgPSAwOwogICAgcmV0dXJuIGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKCFuKSB7CiAgICAgICAgdmFyIGkgPSBEYXRlLm5vdygpIC0gciwKICAgICAgICAgIG8gPSB0aGlzLAogICAgICAgICAgYSA9IGFyZ3VtZW50cywKICAgICAgICAgIHMgPSBmdW5jdGlvbiBzKCkgewogICAgICAgICAgICByID0gRGF0ZS5ub3coKSwgbiA9ICExLCBlLmFwcGx5KG8sIGEpOwogICAgICAgICAgfTsKICAgICAgICBpID49IHQgPyBzKCkgOiBuID0gc2V0VGltZW91dChzLCB0KTsKICAgICAgfQogICAgfTsKICB9CiAgZnVuY3Rpb24gYyhlKSB7CiAgICByZXR1cm4gbnVsbCAhPT0gZSAmJiAib2JqZWN0IiA9PT0gKHZvaWQgMCA9PT0gZSA/ICJ1bmRlZmluZWQiIDogcChlKSk7CiAgfQogIGZ1bmN0aW9uIGgoZSkgewogICAgaWYgKCEoZSBpbnN0YW5jZW9mIE9iamVjdCkpIHJldHVybiBbXTsKICAgIGlmIChPYmplY3Qua2V5cykgcmV0dXJuIE9iamVjdC5rZXlzKGUpOwogICAgdmFyIHQgPSBbXTsKICAgIGZvciAodmFyIG4gaW4gZSkgZS5oYXNPd25Qcm9wZXJ0eShuKSAmJiB0LnB1c2gobik7CiAgICByZXR1cm4gdDsKICB9CiAgZnVuY3Rpb24gZihlKSB7CiAgICBmb3IgKHZhciB0ID0gZS5sZW5ndGgsIG4gPSBbXSwgciA9IDA7IHIgPCB0OyByKyspIG4ucHVzaChlW3JdKTsKICAgIHJldHVybiBuOwogIH0KICBmdW5jdGlvbiB2KCkge30KICB2YXIgcCA9ICJmdW5jdGlvbiIgPT0gdHlwZW9mIFN5bWJvbCAmJiAic3ltYm9sIiA9PSB0eXBlb2YgU3ltYm9sLml0ZXJhdG9yID8gZnVuY3Rpb24gKGUpIHsKICAgICAgcmV0dXJuIHR5cGVvZiBlOwogICAgfSA6IGZ1bmN0aW9uIChlKSB7CiAgICAgIHJldHVybiBlICYmICJmdW5jdGlvbiIgPT0gdHlwZW9mIFN5bWJvbCAmJiBlLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgZSAhPT0gU3ltYm9sLnByb3RvdHlwZSA/ICJzeW1ib2wiIDogdHlwZW9mIGU7CiAgICB9LAogICAgYiA9IGZ1bmN0aW9uIGIoZSwgdCkgewogICAgICBpZiAoIShlIGluc3RhbmNlb2YgdCkpIHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOwogICAgfSwKICAgIHkgPSBmdW5jdGlvbiAoKSB7CiAgICAgIGZ1bmN0aW9uIGUoZSwgdCkgewogICAgICAgIGZvciAodmFyIG4gPSAwOyBuIDwgdC5sZW5ndGg7IG4rKykgewogICAgICAgICAgdmFyIHIgPSB0W25dOwogICAgICAgICAgci5lbnVtZXJhYmxlID0gci5lbnVtZXJhYmxlIHx8ICExLCByLmNvbmZpZ3VyYWJsZSA9ICEwLCAidmFsdWUiIGluIHIgJiYgKHIud3JpdGFibGUgPSAhMCksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLCByLmtleSwgcik7CiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiBmdW5jdGlvbiAodCwgbiwgcikgewogICAgICAgIHJldHVybiBuICYmIGUodC5wcm90b3R5cGUsIG4pLCByICYmIGUodCwgciksIHQ7CiAgICAgIH07CiAgICB9KCksCiAgICBnID0gZnVuY3Rpb24gZyhlKSB7CiAgICAgIHJldHVybiBudWxsID09IGUgfHwgImZ1bmN0aW9uIiAhPSB0eXBlb2YgZSAmJiAib2JqZWN0IiAhPT0gKHZvaWQgMCA9PT0gZSA/ICJ1bmRlZmluZWQiIDogcChlKSk7CiAgICB9LAogICAgbSA9IGZ1bmN0aW9uIG0oZSwgdCkgewogICAgICBpZiAobnVsbCA9PT0gZSB8fCB2b2lkIDAgPT09IGUpIHRocm93IG5ldyBUeXBlRXJyb3IoImV4cGVjdGVkIGZpcnN0IGFyZ3VtZW50IHRvIGJlIGFuIG9iamVjdC4iKTsKICAgICAgaWYgKHZvaWQgMCA9PT0gdCB8fCAidW5kZWZpbmVkIiA9PSB0eXBlb2YgU3ltYm9sKSByZXR1cm4gZTsKICAgICAgaWYgKCJmdW5jdGlvbiIgIT0gdHlwZW9mIE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpIHJldHVybiBlOwogICAgICBmb3IgKHZhciBuID0gT2JqZWN0LnByb3RvdHlwZS5wcm9wZXJ0eUlzRW51bWVyYWJsZSwgciA9IE9iamVjdChlKSwgaSA9IGFyZ3VtZW50cy5sZW5ndGgsIG8gPSAwOyArK28gPCBpOykgZm9yICh2YXIgYSA9IE9iamVjdChhcmd1bWVudHNbb10pLCBzID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhhKSwgdSA9IDA7IHUgPCBzLmxlbmd0aDsgdSsrKSB7CiAgICAgICAgdmFyIGwgPSBzW3VdOwogICAgICAgIG4uY2FsbChhLCBsKSAmJiAocltsXSA9IGFbbF0pOwogICAgICB9CiAgICAgIHJldHVybiByOwogICAgfSwKICAgIHcgPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLAogICAgTCA9IGZ1bmN0aW9uIEwodCkgewogICAgICB2YXIgbiA9IHZvaWQgMCA9PT0gdCA/ICJ1bmRlZmluZWQiIDogcCh0KTsKICAgICAgcmV0dXJuICJ1bmRlZmluZWQiID09PSBuID8gInVuZGVmaW5lZCIgOiBudWxsID09PSB0ID8gIm51bGwiIDogITAgPT09IHQgfHwgITEgPT09IHQgfHwgdCBpbnN0YW5jZW9mIEJvb2xlYW4gPyAiYm9vbGVhbiIgOiAic3RyaW5nIiA9PT0gbiB8fCB0IGluc3RhbmNlb2YgU3RyaW5nID8gInN0cmluZyIgOiAibnVtYmVyIiA9PT0gbiB8fCB0IGluc3RhbmNlb2YgTnVtYmVyID8gIm51bWJlciIgOiAiZnVuY3Rpb24iID09PSBuIHx8IHQgaW5zdGFuY2VvZiBGdW5jdGlvbiA/IHZvaWQgMCAhPT0gdC5jb25zdHJ1Y3Rvci5uYW1lICYmICJHZW5lcmF0b3IiID09PSB0LmNvbnN0cnVjdG9yLm5hbWUuc2xpY2UoMCwgOSkgPyAiZ2VuZXJhdG9yZnVuY3Rpb24iIDogImZ1bmN0aW9uIiA6IHZvaWQgMCAhPT0gQXJyYXkuaXNBcnJheSAmJiBBcnJheS5pc0FycmF5KHQpID8gImFycmF5IiA6IHQgaW5zdGFuY2VvZiBSZWdFeHAgPyAicmVnZXhwIiA6IHQgaW5zdGFuY2VvZiBEYXRlID8gImRhdGUiIDogKG4gPSB3LmNhbGwodCksICJbb2JqZWN0IFJlZ0V4cF0iID09PSBuID8gInJlZ2V4cCIgOiAiW29iamVjdCBEYXRlXSIgPT09IG4gPyAiZGF0ZSIgOiAiW29iamVjdCBBcmd1bWVudHNdIiA9PT0gbiA/ICJhcmd1bWVudHMiIDogIltvYmplY3QgRXJyb3JdIiA9PT0gbiA/ICJlcnJvciIgOiAiW29iamVjdCBQcm9taXNlXSIgPT09IG4gPyAicHJvbWlzZSIgOiBlKHQpID8gImJ1ZmZlciIgOiAiW29iamVjdCBTZXRdIiA9PT0gbiA/ICJzZXQiIDogIltvYmplY3QgV2Vha1NldF0iID09PSBuID8gIndlYWtzZXQiIDogIltvYmplY3QgTWFwXSIgPT09IG4gPyAibWFwIiA6ICJbb2JqZWN0IFdlYWtNYXBdIiA9PT0gbiA/ICJ3ZWFrbWFwIiA6ICJbb2JqZWN0IFN5bWJvbF0iID09PSBuID8gInN5bWJvbCIgOiAiW29iamVjdCBNYXAgSXRlcmF0b3JdIiA9PT0gbiA/ICJtYXBpdGVyYXRvciIgOiAiW29iamVjdCBTZXQgSXRlcmF0b3JdIiA9PT0gbiA/ICJzZXRpdGVyYXRvciIgOiAiW29iamVjdCBTdHJpbmcgSXRlcmF0b3JdIiA9PT0gbiA/ICJzdHJpbmdpdGVyYXRvciIgOiAiW29iamVjdCBBcnJheSBJdGVyYXRvcl0iID09PSBuID8gImFycmF5aXRlcmF0b3IiIDogIltvYmplY3QgSW50OEFycmF5XSIgPT09IG4gPyAiaW50OGFycmF5IiA6ICJbb2JqZWN0IFVpbnQ4QXJyYXldIiA9PT0gbiA/ICJ1aW50OGFycmF5IiA6ICJbb2JqZWN0IFVpbnQ4Q2xhbXBlZEFycmF5XSIgPT09IG4gPyAidWludDhjbGFtcGVkYXJyYXkiIDogIltvYmplY3QgSW50MTZBcnJheV0iID09PSBuID8gImludDE2YXJyYXkiIDogIltvYmplY3QgVWludDE2QXJyYXldIiA9PT0gbiA/ICJ1aW50MTZhcnJheSIgOiAiW29iamVjdCBJbnQzMkFycmF5XSIgPT09IG4gPyAiaW50MzJhcnJheSIgOiAiW29iamVjdCBVaW50MzJBcnJheV0iID09PSBuID8gInVpbnQzMmFycmF5IiA6ICJbb2JqZWN0IEZsb2F0MzJBcnJheV0iID09PSBuID8gImZsb2F0MzJhcnJheSIgOiAiW29iamVjdCBGbG9hdDY0QXJyYXldIiA9PT0gbiA/ICJmbG9hdDY0YXJyYXkiIDogIm9iamVjdCIpOwogICAgfSwKICAgIF8gPSB0LAogICAgayA9ICJ1bmRlZmluZWQiICE9IHR5cGVvZiB3aW5kb3csCiAgICBFID0gayAmJiAiSW50ZXJzZWN0aW9uT2JzZXJ2ZXIiIGluIHdpbmRvdywKICAgIEEgPSB7CiAgICAgIGV2ZW50OiAiZXZlbnQiLAogICAgICBvYnNlcnZlcjogIm9ic2VydmVyIgogICAgfSwKICAgIGogPSBmdW5jdGlvbiAoKSB7CiAgICAgIGZ1bmN0aW9uIGUoZSwgdCkgewogICAgICAgIHQgPSB0IHx8IHsKICAgICAgICAgIGJ1YmJsZXM6ICExLAogICAgICAgICAgY2FuY2VsYWJsZTogITEsCiAgICAgICAgICBkZXRhaWw6IHZvaWQgMAogICAgICAgIH07CiAgICAgICAgdmFyIG4gPSBkb2N1bWVudC5jcmVhdGVFdmVudCgiQ3VzdG9tRXZlbnQiKTsKICAgICAgICByZXR1cm4gbi5pbml0Q3VzdG9tRXZlbnQoZSwgdC5idWJibGVzLCB0LmNhbmNlbGFibGUsIHQuZGV0YWlsKSwgbjsKICAgICAgfQogICAgICBpZiAoaykgcmV0dXJuICJmdW5jdGlvbiIgPT0gdHlwZW9mIHdpbmRvdy5DdXN0b21FdmVudCA/IHdpbmRvdy5DdXN0b21FdmVudCA6IChlLnByb3RvdHlwZSA9IHdpbmRvdy5FdmVudC5wcm90b3R5cGUsIGUpOwogICAgfSgpLAogICAgeiA9IGZ1bmN0aW9uIHooKSB7CiAgICAgIHZhciBlID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgdm9pZCAwICE9PSBhcmd1bWVudHNbMF0gPyBhcmd1bWVudHNbMF0gOiAxOwogICAgICByZXR1cm4gayA/IHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvIHx8IGUgOiBlOwogICAgfSwKICAgIFQgPSBmdW5jdGlvbiAoKSB7CiAgICAgIGlmIChrKSB7CiAgICAgICAgdmFyIGUgPSAhMTsKICAgICAgICB0cnkgewogICAgICAgICAgdmFyIHQgPSBPYmplY3QuZGVmaW5lUHJvcGVydHkoe30sICJwYXNzaXZlIiwgewogICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgICAgICAgICBlID0gITA7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoInRlc3QiLCBudWxsLCB0KTsKICAgICAgICB9IGNhdGNoIChlKSB7fQogICAgICAgIHJldHVybiBlOwogICAgICB9CiAgICB9KCksCiAgICBPID0gewogICAgICBvbjogZnVuY3Rpb24gb24oZSwgdCwgbikgewogICAgICAgIHZhciByID0gYXJndW1lbnRzLmxlbmd0aCA+IDMgJiYgdm9pZCAwICE9PSBhcmd1bWVudHNbM10gJiYgYXJndW1lbnRzWzNdOwogICAgICAgIFQgPyBlLmFkZEV2ZW50TGlzdGVuZXIodCwgbiwgewogICAgICAgICAgY2FwdHVyZTogciwKICAgICAgICAgIHBhc3NpdmU6ICEwCiAgICAgICAgfSkgOiBlLmFkZEV2ZW50TGlzdGVuZXIodCwgbiwgcik7CiAgICAgIH0sCiAgICAgIG9mZjogZnVuY3Rpb24gb2ZmKGUsIHQsIG4pIHsKICAgICAgICB2YXIgciA9IGFyZ3VtZW50cy5sZW5ndGggPiAzICYmIHZvaWQgMCAhPT0gYXJndW1lbnRzWzNdICYmIGFyZ3VtZW50c1szXTsKICAgICAgICBlLnJlbW92ZUV2ZW50TGlzdGVuZXIodCwgbiwgcik7CiAgICAgIH0KICAgIH0sCiAgICBJID0gZnVuY3Rpb24gSShlLCB0LCBuKSB7CiAgICAgIHZhciByID0gbmV3IEltYWdlKCk7CiAgICAgIHIuc3JjID0gZS5zcmMsIHIub25sb2FkID0gZnVuY3Rpb24gKCkgewogICAgICAgIHQoewogICAgICAgICAgbmF0dXJhbEhlaWdodDogci5uYXR1cmFsSGVpZ2h0LAogICAgICAgICAgbmF0dXJhbFdpZHRoOiByLm5hdHVyYWxXaWR0aCwKICAgICAgICAgIHNyYzogci5zcmMKICAgICAgICB9KTsKICAgICAgfSwgci5vbmVycm9yID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICBuKGUpOwogICAgICB9OwogICAgfSwKICAgIHggPSBmdW5jdGlvbiB4KGUsIHQpIHsKICAgICAgcmV0dXJuICJ1bmRlZmluZWQiICE9IHR5cGVvZiBnZXRDb21wdXRlZFN0eWxlID8gZ2V0Q29tcHV0ZWRTdHlsZShlLCBudWxsKS5nZXRQcm9wZXJ0eVZhbHVlKHQpIDogZS5zdHlsZVt0XTsKICAgIH0sCiAgICBTID0gZnVuY3Rpb24gUyhlKSB7CiAgICAgIHJldHVybiB4KGUsICJvdmVyZmxvdyIpICsgeChlLCAib3ZlcmZsb3cteSIpICsgeChlLCAib3ZlcmZsb3cteCIpOwogICAgfSwKICAgICQgPSBmdW5jdGlvbiAkKGUpIHsKICAgICAgaWYgKGspIHsKICAgICAgICBpZiAoIShlIGluc3RhbmNlb2YgSFRNTEVsZW1lbnQpKSByZXR1cm4gd2luZG93OwogICAgICAgIGZvciAodmFyIHQgPSBlOyB0ICYmIHQgIT09IGRvY3VtZW50LmJvZHkgJiYgdCAhPT0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50ICYmIHQucGFyZW50Tm9kZTspIHsKICAgICAgICAgIGlmICgvKHNjcm9sbHxhdXRvKS8udGVzdChTKHQpKSkgcmV0dXJuIHQ7CiAgICAgICAgICB0ID0gdC5wYXJlbnROb2RlOwogICAgICAgIH0KICAgICAgICByZXR1cm4gd2luZG93OwogICAgICB9CiAgICB9LAogICAgSCA9IHt9LAogICAgUSA9IGZ1bmN0aW9uICgpIHsKICAgICAgZnVuY3Rpb24gZSh0KSB7CiAgICAgICAgdmFyIG4gPSB0LmVsLAogICAgICAgICAgciA9IHQuc3JjLAogICAgICAgICAgaSA9IHQuZXJyb3IsCiAgICAgICAgICBvID0gdC5sb2FkaW5nLAogICAgICAgICAgYSA9IHQuYmluZFR5cGUsCiAgICAgICAgICBzID0gdC4kcGFyZW50LAogICAgICAgICAgdSA9IHQub3B0aW9ucywKICAgICAgICAgIGwgPSB0LmVsUmVuZGVyZXI7CiAgICAgICAgYih0aGlzLCBlKSwgdGhpcy5lbCA9IG4sIHRoaXMuc3JjID0gciwgdGhpcy5lcnJvciA9IGksIHRoaXMubG9hZGluZyA9IG8sIHRoaXMuYmluZFR5cGUgPSBhLCB0aGlzLmF0dGVtcHQgPSAwLCB0aGlzLm5hdHVyYWxIZWlnaHQgPSAwLCB0aGlzLm5hdHVyYWxXaWR0aCA9IDAsIHRoaXMub3B0aW9ucyA9IHUsIHRoaXMucmVjdCA9IG51bGwsIHRoaXMuJHBhcmVudCA9IHMsIHRoaXMuZWxSZW5kZXJlciA9IGwsIHRoaXMucGVyZm9ybWFuY2VEYXRhID0gewogICAgICAgICAgaW5pdDogRGF0ZS5ub3coKSwKICAgICAgICAgIGxvYWRTdGFydDogMCwKICAgICAgICAgIGxvYWRFbmQ6IDAKICAgICAgICB9LCB0aGlzLmZpbHRlcigpLCB0aGlzLmluaXRTdGF0ZSgpLCB0aGlzLnJlbmRlcigibG9hZGluZyIsICExKTsKICAgICAgfQogICAgICByZXR1cm4geShlLCBbewogICAgICAgIGtleTogImluaXRTdGF0ZSIsCiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKCkgewogICAgICAgICAgdGhpcy5lbC5kYXRhc2V0LnNyYyA9IHRoaXMuc3JjLCB0aGlzLnN0YXRlID0gewogICAgICAgICAgICBlcnJvcjogITEsCiAgICAgICAgICAgIGxvYWRlZDogITEsCiAgICAgICAgICAgIHJlbmRlcmVkOiAhMQogICAgICAgICAgfTsKICAgICAgICB9CiAgICAgIH0sIHsKICAgICAgICBrZXk6ICJyZWNvcmQiLAogICAgICAgIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZShlKSB7CiAgICAgICAgICB0aGlzLnBlcmZvcm1hbmNlRGF0YVtlXSA9IERhdGUubm93KCk7CiAgICAgICAgfQogICAgICB9LCB7CiAgICAgICAga2V5OiAidXBkYXRlIiwKICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoZSkgewogICAgICAgICAgdmFyIHQgPSBlLnNyYywKICAgICAgICAgICAgbiA9IGUubG9hZGluZywKICAgICAgICAgICAgciA9IGUuZXJyb3IsCiAgICAgICAgICAgIGkgPSB0aGlzLnNyYzsKICAgICAgICAgIHRoaXMuc3JjID0gdCwgdGhpcy5sb2FkaW5nID0gbiwgdGhpcy5lcnJvciA9IHIsIHRoaXMuZmlsdGVyKCksIGkgIT09IHRoaXMuc3JjICYmICh0aGlzLmF0dGVtcHQgPSAwLCB0aGlzLmluaXRTdGF0ZSgpKTsKICAgICAgICB9CiAgICAgIH0sIHsKICAgICAgICBrZXk6ICJnZXRSZWN0IiwKICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoKSB7CiAgICAgICAgICB0aGlzLnJlY3QgPSB0aGlzLmVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOwogICAgICAgIH0KICAgICAgfSwgewogICAgICAgIGtleTogImNoZWNrSW5WaWV3IiwKICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoKSB7CiAgICAgICAgICByZXR1cm4gdGhpcy5nZXRSZWN0KCksIHRoaXMucmVjdC50b3AgPCB3aW5kb3cuaW5uZXJIZWlnaHQgKiB0aGlzLm9wdGlvbnMucHJlTG9hZCAmJiB0aGlzLnJlY3QuYm90dG9tID4gdGhpcy5vcHRpb25zLnByZUxvYWRUb3AgJiYgdGhpcy5yZWN0LmxlZnQgPCB3aW5kb3cuaW5uZXJXaWR0aCAqIHRoaXMub3B0aW9ucy5wcmVMb2FkICYmIHRoaXMucmVjdC5yaWdodCA+IDA7CiAgICAgICAgfQogICAgICB9LCB7CiAgICAgICAga2V5OiAiZmlsdGVyIiwKICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoKSB7CiAgICAgICAgICB2YXIgZSA9IHRoaXM7CiAgICAgICAgICBoKHRoaXMub3B0aW9ucy5maWx0ZXIpLm1hcChmdW5jdGlvbiAodCkgewogICAgICAgICAgICBlLm9wdGlvbnMuZmlsdGVyW3RdKGUsIGUub3B0aW9ucyk7CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0sIHsKICAgICAgICBrZXk6ICJyZW5kZXJMb2FkaW5nIiwKICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoZSkgewogICAgICAgICAgdmFyIHQgPSB0aGlzOwogICAgICAgICAgSSh7CiAgICAgICAgICAgIHNyYzogdGhpcy5sb2FkaW5nCiAgICAgICAgICB9LCBmdW5jdGlvbiAobikgewogICAgICAgICAgICB0LnJlbmRlcigibG9hZGluZyIsICExKSwgZSgpOwogICAgICAgICAgfSwgZnVuY3Rpb24gKCkgewogICAgICAgICAgICBlKCksIHQub3B0aW9ucy5zaWxlbnQgfHwgY29uc29sZS53YXJuKCJWdWVMYXp5bG9hZCBsb2c6IGxvYWQgZmFpbGVkIHdpdGggbG9hZGluZyBpbWFnZSgiICsgdC5sb2FkaW5nICsgIikiKTsKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSwgewogICAgICAgIGtleTogImxvYWQiLAogICAgICAgIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSgpIHsKICAgICAgICAgIHZhciBlID0gdGhpcywKICAgICAgICAgICAgdCA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIHZvaWQgMCAhPT0gYXJndW1lbnRzWzBdID8gYXJndW1lbnRzWzBdIDogdjsKICAgICAgICAgIHJldHVybiB0aGlzLmF0dGVtcHQgPiB0aGlzLm9wdGlvbnMuYXR0ZW1wdCAtIDEgJiYgdGhpcy5zdGF0ZS5lcnJvciA/ICh0aGlzLm9wdGlvbnMuc2lsZW50IHx8IGNvbnNvbGUubG9nKCJWdWVMYXp5bG9hZCBsb2c6ICIgKyB0aGlzLnNyYyArICIgdHJpZWQgdG9vIG1vcmUgdGhhbiAiICsgdGhpcy5vcHRpb25zLmF0dGVtcHQgKyAiIHRpbWVzIiksIHZvaWQgdCgpKSA6IHRoaXMuc3RhdGUubG9hZGVkIHx8IEhbdGhpcy5zcmNdID8gKHRoaXMuc3RhdGUubG9hZGVkID0gITAsIHQoKSwgdGhpcy5yZW5kZXIoImxvYWRlZCIsICEwKSkgOiB2b2lkIHRoaXMucmVuZGVyTG9hZGluZyhmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIGUuYXR0ZW1wdCsrLCBlLnJlY29yZCgibG9hZFN0YXJ0IiksIEkoewogICAgICAgICAgICAgIHNyYzogZS5zcmMKICAgICAgICAgICAgfSwgZnVuY3Rpb24gKG4pIHsKICAgICAgICAgICAgICBlLm5hdHVyYWxIZWlnaHQgPSBuLm5hdHVyYWxIZWlnaHQsIGUubmF0dXJhbFdpZHRoID0gbi5uYXR1cmFsV2lkdGgsIGUuc3RhdGUubG9hZGVkID0gITAsIGUuc3RhdGUuZXJyb3IgPSAhMSwgZS5yZWNvcmQoImxvYWRFbmQiKSwgZS5yZW5kZXIoImxvYWRlZCIsICExKSwgSFtlLnNyY10gPSAxLCB0KCk7CiAgICAgICAgICAgIH0sIGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgICAgIWUub3B0aW9ucy5zaWxlbnQgJiYgY29uc29sZS5lcnJvcih0KSwgZS5zdGF0ZS5lcnJvciA9ICEwLCBlLnN0YXRlLmxvYWRlZCA9ICExLCBlLnJlbmRlcigiZXJyb3IiLCAhMSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9LCB7CiAgICAgICAga2V5OiAicmVuZGVyIiwKICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoZSwgdCkgewogICAgICAgICAgdGhpcy5lbFJlbmRlcmVyKHRoaXMsIGUsIHQpOwogICAgICAgIH0KICAgICAgfSwgewogICAgICAgIGtleTogInBlcmZvcm1hbmNlIiwKICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoKSB7CiAgICAgICAgICB2YXIgZSA9ICJsb2FkaW5nIiwKICAgICAgICAgICAgdCA9IDA7CiAgICAgICAgICByZXR1cm4gdGhpcy5zdGF0ZS5sb2FkZWQgJiYgKGUgPSAibG9hZGVkIiwgdCA9ICh0aGlzLnBlcmZvcm1hbmNlRGF0YS5sb2FkRW5kIC0gdGhpcy5wZXJmb3JtYW5jZURhdGEubG9hZFN0YXJ0KSAvIDFlMyksIHRoaXMuc3RhdGUuZXJyb3IgJiYgKGUgPSAiZXJyb3IiKSwgewogICAgICAgICAgICBzcmM6IHRoaXMuc3JjLAogICAgICAgICAgICBzdGF0ZTogZSwKICAgICAgICAgICAgdGltZTogdAogICAgICAgICAgfTsKICAgICAgICB9CiAgICAgIH0sIHsKICAgICAgICBrZXk6ICJkZXN0cm95IiwKICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoKSB7CiAgICAgICAgICB0aGlzLmVsID0gbnVsbCwgdGhpcy5zcmMgPSBudWxsLCB0aGlzLmVycm9yID0gbnVsbCwgdGhpcy5sb2FkaW5nID0gbnVsbCwgdGhpcy5iaW5kVHlwZSA9IG51bGwsIHRoaXMuYXR0ZW1wdCA9IDA7CiAgICAgICAgfQogICAgICB9XSksIGU7CiAgICB9KCksCiAgICBDID0gImRhdGE6aW1hZ2UvZ2lmO2Jhc2U2NCxSMGxHT0RsaEFRQUJBSUFBQUFBQUFQLy8veUg1QkFFQUFBQUFMQUFBQUFBQkFBRUFBQUlCUkFBNyIsCiAgICBSID0gWyJzY3JvbGwiLCAid2hlZWwiLCAibW91c2V3aGVlbCIsICJyZXNpemUiLCAiYW5pbWF0aW9uZW5kIiwgInRyYW5zaXRpb25lbmQiLCAidG91Y2htb3ZlIl0sCiAgICBXID0gewogICAgICByb290TWFyZ2luOiAiMHB4IiwKICAgICAgdGhyZXNob2xkOiAwCiAgICB9LAogICAgRCA9IGZ1bmN0aW9uIEQoZSkgewogICAgICByZXR1cm4gZnVuY3Rpb24gKCkgewogICAgICAgIGZ1bmN0aW9uIHQoZSkgewogICAgICAgICAgdmFyIG4gPSBlLnByZUxvYWQsCiAgICAgICAgICAgIHIgPSBlLmVycm9yLAogICAgICAgICAgICBpID0gZS50aHJvdHRsZVdhaXQsCiAgICAgICAgICAgIG8gPSBlLnByZUxvYWRUb3AsCiAgICAgICAgICAgIGEgPSBlLmRpc3BhdGNoRXZlbnQsCiAgICAgICAgICAgIHMgPSBlLmxvYWRpbmcsCiAgICAgICAgICAgIHUgPSBlLmF0dGVtcHQsCiAgICAgICAgICAgIGMgPSBlLnNpbGVudCwKICAgICAgICAgICAgaCA9IHZvaWQgMCA9PT0gYyB8fCBjLAogICAgICAgICAgICBmID0gZS5zY2FsZSwKICAgICAgICAgICAgdiA9IGUubGlzdGVuRXZlbnRzLAogICAgICAgICAgICBwID0gKGUuaGFzYmluZCwgZS5maWx0ZXIpLAogICAgICAgICAgICB5ID0gZS5hZGFwdGVyLAogICAgICAgICAgICBnID0gZS5vYnNlcnZlciwKICAgICAgICAgICAgbSA9IGUub2JzZXJ2ZXJPcHRpb25zOwogICAgICAgICAgYih0aGlzLCB0KSwgdGhpcy52ZXJzaW9uID0gIjEuMi4zIiwgdGhpcy5tb2RlID0gQS5ldmVudCwgdGhpcy5MaXN0ZW5lclF1ZXVlID0gW10sIHRoaXMuVGFyZ2V0SW5kZXggPSAwLCB0aGlzLlRhcmdldFF1ZXVlID0gW10sIHRoaXMub3B0aW9ucyA9IHsKICAgICAgICAgICAgc2lsZW50OiBoLAogICAgICAgICAgICBkaXNwYXRjaEV2ZW50OiAhIWEsCiAgICAgICAgICAgIHRocm90dGxlV2FpdDogaSB8fCAyMDAsCiAgICAgICAgICAgIHByZUxvYWQ6IG4gfHwgMS4zLAogICAgICAgICAgICBwcmVMb2FkVG9wOiBvIHx8IDAsCiAgICAgICAgICAgIGVycm9yOiByIHx8IEMsCiAgICAgICAgICAgIGxvYWRpbmc6IHMgfHwgQywKICAgICAgICAgICAgYXR0ZW1wdDogdSB8fCAzLAogICAgICAgICAgICBzY2FsZTogZiB8fCB6KGYpLAogICAgICAgICAgICBMaXN0ZW5FdmVudHM6IHYgfHwgUiwKICAgICAgICAgICAgaGFzYmluZDogITEsCiAgICAgICAgICAgIHN1cHBvcnRXZWJwOiBsKCksCiAgICAgICAgICAgIGZpbHRlcjogcCB8fCB7fSwKICAgICAgICAgICAgYWRhcHRlcjogeSB8fCB7fSwKICAgICAgICAgICAgb2JzZXJ2ZXI6ICEhZywKICAgICAgICAgICAgb2JzZXJ2ZXJPcHRpb25zOiBtIHx8IFcKICAgICAgICAgIH0sIHRoaXMuX2luaXRFdmVudCgpLCB0aGlzLmxhenlMb2FkSGFuZGxlciA9IGQodGhpcy5fbGF6eUxvYWRIYW5kbGVyLmJpbmQodGhpcyksIHRoaXMub3B0aW9ucy50aHJvdHRsZVdhaXQpLCB0aGlzLnNldE1vZGUodGhpcy5vcHRpb25zLm9ic2VydmVyID8gQS5vYnNlcnZlciA6IEEuZXZlbnQpOwogICAgICAgIH0KICAgICAgICByZXR1cm4geSh0LCBbewogICAgICAgICAga2V5OiAiY29uZmlnIiwKICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSgpIHsKICAgICAgICAgICAgdmFyIGUgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiB2b2lkIDAgIT09IGFyZ3VtZW50c1swXSA/IGFyZ3VtZW50c1swXSA6IHt9OwogICAgICAgICAgICBfKHRoaXMub3B0aW9ucywgZSk7CiAgICAgICAgICB9CiAgICAgICAgfSwgewogICAgICAgICAga2V5OiAicGVyZm9ybWFuY2UiLAogICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKCkgewogICAgICAgICAgICB2YXIgZSA9IFtdOwogICAgICAgICAgICByZXR1cm4gdGhpcy5MaXN0ZW5lclF1ZXVlLm1hcChmdW5jdGlvbiAodCkgewogICAgICAgICAgICAgIGUucHVzaCh0LnBlcmZvcm1hbmNlKCkpOwogICAgICAgICAgICB9KSwgZTsKICAgICAgICAgIH0KICAgICAgICB9LCB7CiAgICAgICAgICBrZXk6ICJhZGRMYXp5Qm94IiwKICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZShlKSB7CiAgICAgICAgICAgIHRoaXMuTGlzdGVuZXJRdWV1ZS5wdXNoKGUpLCBrICYmICh0aGlzLl9hZGRMaXN0ZW5lclRhcmdldCh3aW5kb3cpLCB0aGlzLl9vYnNlcnZlciAmJiB0aGlzLl9vYnNlcnZlci5vYnNlcnZlKGUuZWwpLCBlLiRlbCAmJiBlLiRlbC5wYXJlbnROb2RlICYmIHRoaXMuX2FkZExpc3RlbmVyVGFyZ2V0KGUuJGVsLnBhcmVudE5vZGUpKTsKICAgICAgICAgIH0KICAgICAgICB9LCB7CiAgICAgICAgICBrZXk6ICJhZGQiLAogICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKHQsIG4sIHIpIHsKICAgICAgICAgICAgdmFyIGkgPSB0aGlzOwogICAgICAgICAgICBpZiAoYSh0aGlzLkxpc3RlbmVyUXVldWUsIGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgICAgcmV0dXJuIGUuZWwgPT09IHQ7CiAgICAgICAgICAgIH0pKSByZXR1cm4gdGhpcy51cGRhdGUodCwgbiksIGUubmV4dFRpY2sodGhpcy5sYXp5TG9hZEhhbmRsZXIpOwogICAgICAgICAgICB2YXIgbyA9IHRoaXMuX3ZhbHVlRm9ybWF0dGVyKG4udmFsdWUpLAogICAgICAgICAgICAgIHUgPSBvLnNyYywKICAgICAgICAgICAgICBsID0gby5sb2FkaW5nLAogICAgICAgICAgICAgIGQgPSBvLmVycm9yOwogICAgICAgICAgICBlLm5leHRUaWNrKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICB1ID0gcyh0LCBpLm9wdGlvbnMuc2NhbGUpIHx8IHUsIGkuX29ic2VydmVyICYmIGkuX29ic2VydmVyLm9ic2VydmUodCk7CiAgICAgICAgICAgICAgdmFyIG8gPSBPYmplY3Qua2V5cyhuLm1vZGlmaWVycylbMF0sCiAgICAgICAgICAgICAgICBhID0gdm9pZCAwOwogICAgICAgICAgICAgIG8gJiYgKGEgPSByLmNvbnRleHQuJHJlZnNbb10sIGEgPSBhID8gYS4kZWwgfHwgYSA6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKG8pKSwgYSB8fCAoYSA9ICQodCkpOwogICAgICAgICAgICAgIHZhciBjID0gbmV3IFEoewogICAgICAgICAgICAgICAgYmluZFR5cGU6IG4uYXJnLAogICAgICAgICAgICAgICAgJHBhcmVudDogYSwKICAgICAgICAgICAgICAgIGVsOiB0LAogICAgICAgICAgICAgICAgbG9hZGluZzogbCwKICAgICAgICAgICAgICAgIGVycm9yOiBkLAogICAgICAgICAgICAgICAgc3JjOiB1LAogICAgICAgICAgICAgICAgZWxSZW5kZXJlcjogaS5fZWxSZW5kZXJlci5iaW5kKGkpLAogICAgICAgICAgICAgICAgb3B0aW9uczogaS5vcHRpb25zCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgaS5MaXN0ZW5lclF1ZXVlLnB1c2goYyksIGsgJiYgKGkuX2FkZExpc3RlbmVyVGFyZ2V0KHdpbmRvdyksIGkuX2FkZExpc3RlbmVyVGFyZ2V0KGEpKSwgaS5sYXp5TG9hZEhhbmRsZXIoKSwgZS5uZXh0VGljayhmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gaS5sYXp5TG9hZEhhbmRsZXIoKTsKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfSwgewogICAgICAgICAga2V5OiAidXBkYXRlIiwKICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSh0LCBuKSB7CiAgICAgICAgICAgIHZhciByID0gdGhpcywKICAgICAgICAgICAgICBpID0gdGhpcy5fdmFsdWVGb3JtYXR0ZXIobi52YWx1ZSksCiAgICAgICAgICAgICAgbyA9IGkuc3JjLAogICAgICAgICAgICAgIGEgPSBpLmxvYWRpbmcsCiAgICAgICAgICAgICAgbCA9IGkuZXJyb3I7CiAgICAgICAgICAgIG8gPSBzKHQsIHRoaXMub3B0aW9ucy5zY2FsZSkgfHwgbzsKICAgICAgICAgICAgdmFyIGQgPSB1KHRoaXMuTGlzdGVuZXJRdWV1ZSwgZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICByZXR1cm4gZS5lbCA9PT0gdDsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGQgJiYgZC51cGRhdGUoewogICAgICAgICAgICAgIHNyYzogbywKICAgICAgICAgICAgICBsb2FkaW5nOiBhLAogICAgICAgICAgICAgIGVycm9yOiBsCiAgICAgICAgICAgIH0pLCB0aGlzLl9vYnNlcnZlciAmJiAodGhpcy5fb2JzZXJ2ZXIudW5vYnNlcnZlKHQpLCB0aGlzLl9vYnNlcnZlci5vYnNlcnZlKHQpKSwgdGhpcy5sYXp5TG9hZEhhbmRsZXIoKSwgZS5uZXh0VGljayhmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgcmV0dXJuIHIubGF6eUxvYWRIYW5kbGVyKCk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH0sIHsKICAgICAgICAgIGtleTogInJlbW92ZSIsCiAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoZSkgewogICAgICAgICAgICBpZiAoZSkgewogICAgICAgICAgICAgIHRoaXMuX29ic2VydmVyICYmIHRoaXMuX29ic2VydmVyLnVub2JzZXJ2ZShlKTsKICAgICAgICAgICAgICB2YXIgdCA9IHUodGhpcy5MaXN0ZW5lclF1ZXVlLCBmdW5jdGlvbiAodCkgewogICAgICAgICAgICAgICAgcmV0dXJuIHQuZWwgPT09IGU7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgdCAmJiAodGhpcy5fcmVtb3ZlTGlzdGVuZXJUYXJnZXQodC4kcGFyZW50KSwgdGhpcy5fcmVtb3ZlTGlzdGVuZXJUYXJnZXQod2luZG93KSwgbyh0aGlzLkxpc3RlbmVyUXVldWUsIHQpICYmIHQuZGVzdHJveSgpKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIHsKICAgICAgICAgIGtleTogInJlbW92ZUNvbXBvbmVudCIsCiAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoZSkgewogICAgICAgICAgICBlICYmIChvKHRoaXMuTGlzdGVuZXJRdWV1ZSwgZSksIHRoaXMuX29ic2VydmVyICYmIHRoaXMuX29ic2VydmVyLnVub2JzZXJ2ZShlLmVsKSwgZS4kcGFyZW50ICYmIGUuJGVsLnBhcmVudE5vZGUgJiYgdGhpcy5fcmVtb3ZlTGlzdGVuZXJUYXJnZXQoZS4kZWwucGFyZW50Tm9kZSksIHRoaXMuX3JlbW92ZUxpc3RlbmVyVGFyZ2V0KHdpbmRvdykpOwogICAgICAgICAgfQogICAgICAgIH0sIHsKICAgICAgICAgIGtleTogInNldE1vZGUiLAogICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKGUpIHsKICAgICAgICAgICAgdmFyIHQgPSB0aGlzOwogICAgICAgICAgICBFIHx8IGUgIT09IEEub2JzZXJ2ZXIgfHwgKGUgPSBBLmV2ZW50KSwgdGhpcy5tb2RlID0gZSwgZSA9PT0gQS5ldmVudCA/ICh0aGlzLl9vYnNlcnZlciAmJiAodGhpcy5MaXN0ZW5lclF1ZXVlLmZvckVhY2goZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICB0Ll9vYnNlcnZlci51bm9ic2VydmUoZS5lbCk7CiAgICAgICAgICAgIH0pLCB0aGlzLl9vYnNlcnZlciA9IG51bGwpLCB0aGlzLlRhcmdldFF1ZXVlLmZvckVhY2goZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICB0Ll9pbml0TGlzdGVuKGUuZWwsICEwKTsKICAgICAgICAgICAgfSkpIDogKHRoaXMuVGFyZ2V0UXVldWUuZm9yRWFjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgIHQuX2luaXRMaXN0ZW4oZS5lbCwgITEpOwogICAgICAgICAgICB9KSwgdGhpcy5faW5pdEludGVyc2VjdGlvbk9ic2VydmVyKCkpOwogICAgICAgICAgfQogICAgICAgIH0sIHsKICAgICAgICAgIGtleTogIl9hZGRMaXN0ZW5lclRhcmdldCIsCiAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoZSkgewogICAgICAgICAgICBpZiAoZSkgewogICAgICAgICAgICAgIHZhciB0ID0gdSh0aGlzLlRhcmdldFF1ZXVlLCBmdW5jdGlvbiAodCkgewogICAgICAgICAgICAgICAgcmV0dXJuIHQuZWwgPT09IGU7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgcmV0dXJuIHQgPyB0LmNoaWxkcmVuQ291bnQrKyA6ICh0ID0gewogICAgICAgICAgICAgICAgZWw6IGUsCiAgICAgICAgICAgICAgICBpZDogKyt0aGlzLlRhcmdldEluZGV4LAogICAgICAgICAgICAgICAgY2hpbGRyZW5Db3VudDogMSwKICAgICAgICAgICAgICAgIGxpc3RlbmVkOiAhMAogICAgICAgICAgICAgIH0sIHRoaXMubW9kZSA9PT0gQS5ldmVudCAmJiB0aGlzLl9pbml0TGlzdGVuKHQuZWwsICEwKSwgdGhpcy5UYXJnZXRRdWV1ZS5wdXNoKHQpKSwgdGhpcy5UYXJnZXRJbmRleDsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIHsKICAgICAgICAgIGtleTogIl9yZW1vdmVMaXN0ZW5lclRhcmdldCIsCiAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoZSkgewogICAgICAgICAgICB2YXIgdCA9IHRoaXM7CiAgICAgICAgICAgIHRoaXMuVGFyZ2V0UXVldWUuZm9yRWFjaChmdW5jdGlvbiAobiwgcikgewogICAgICAgICAgICAgIG4uZWwgPT09IGUgJiYgKC0tbi5jaGlsZHJlbkNvdW50IHx8ICh0Ll9pbml0TGlzdGVuKG4uZWwsICExKSwgdC5UYXJnZXRRdWV1ZS5zcGxpY2UociwgMSksIG4gPSBudWxsKSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH0sIHsKICAgICAgICAgIGtleTogIl9pbml0TGlzdGVuIiwKICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZShlLCB0KSB7CiAgICAgICAgICAgIHZhciBuID0gdGhpczsKICAgICAgICAgICAgdGhpcy5vcHRpb25zLkxpc3RlbkV2ZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChyKSB7CiAgICAgICAgICAgICAgcmV0dXJuIE9bdCA/ICJvbiIgOiAib2ZmIl0oZSwgciwgbi5sYXp5TG9hZEhhbmRsZXIpOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9LCB7CiAgICAgICAgICBrZXk6ICJfaW5pdEV2ZW50IiwKICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSgpIHsKICAgICAgICAgICAgdmFyIGUgPSB0aGlzOwogICAgICAgICAgICB0aGlzLkV2ZW50ID0gewogICAgICAgICAgICAgIGxpc3RlbmVyczogewogICAgICAgICAgICAgICAgbG9hZGluZzogW10sCiAgICAgICAgICAgICAgICBsb2FkZWQ6IFtdLAogICAgICAgICAgICAgICAgZXJyb3I6IFtdCiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LCB0aGlzLiRvbiA9IGZ1bmN0aW9uICh0LCBuKSB7CiAgICAgICAgICAgICAgZS5FdmVudC5saXN0ZW5lcnNbdF0ucHVzaChuKTsKICAgICAgICAgICAgfSwgdGhpcy4kb25jZSA9IGZ1bmN0aW9uICh0LCBuKSB7CiAgICAgICAgICAgICAgZnVuY3Rpb24gcigpIHsKICAgICAgICAgICAgICAgIGkuJG9mZih0LCByKSwgbi5hcHBseShpLCBhcmd1bWVudHMpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB2YXIgaSA9IGU7CiAgICAgICAgICAgICAgZS4kb24odCwgcik7CiAgICAgICAgICAgIH0sIHRoaXMuJG9mZiA9IGZ1bmN0aW9uICh0LCBuKSB7CiAgICAgICAgICAgICAgaWYgKCFuKSByZXR1cm4gdm9pZCAoZS5FdmVudC5saXN0ZW5lcnNbdF0gPSBbXSk7CiAgICAgICAgICAgICAgbyhlLkV2ZW50Lmxpc3RlbmVyc1t0XSwgbik7CiAgICAgICAgICAgIH0sIHRoaXMuJGVtaXQgPSBmdW5jdGlvbiAodCwgbiwgcikgewogICAgICAgICAgICAgIGUuRXZlbnQubGlzdGVuZXJzW3RdLmZvckVhY2goZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICAgIHJldHVybiBlKG4sIHIpOwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9OwogICAgICAgICAgfQogICAgICAgIH0sIHsKICAgICAgICAgIGtleTogIl9sYXp5TG9hZEhhbmRsZXIiLAogICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKCkgewogICAgICAgICAgICB2YXIgZSA9IHRoaXMsCiAgICAgICAgICAgICAgdCA9ICExOwogICAgICAgICAgICB0aGlzLkxpc3RlbmVyUXVldWUuZm9yRWFjaChmdW5jdGlvbiAobiwgcikgewogICAgICAgICAgICAgIG4uc3RhdGUubG9hZGVkIHx8ICh0ID0gbi5jaGVja0luVmlldygpKSAmJiBuLmxvYWQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgIW4uZXJyb3IgJiYgbi5sb2FkZWQgJiYgZS5MaXN0ZW5lclF1ZXVlLnNwbGljZShyLCAxKTsKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfSwgewogICAgICAgICAga2V5OiAiX2luaXRJbnRlcnNlY3Rpb25PYnNlcnZlciIsCiAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoKSB7CiAgICAgICAgICAgIHZhciBlID0gdGhpczsKICAgICAgICAgICAgRSAmJiAodGhpcy5fb2JzZXJ2ZXIgPSBuZXcgSW50ZXJzZWN0aW9uT2JzZXJ2ZXIodGhpcy5fb2JzZXJ2ZXJIYW5kbGVyLmJpbmQodGhpcyksIHRoaXMub3B0aW9ucy5vYnNlcnZlck9wdGlvbnMpLCB0aGlzLkxpc3RlbmVyUXVldWUubGVuZ3RoICYmIHRoaXMuTGlzdGVuZXJRdWV1ZS5mb3JFYWNoKGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgICAgZS5fb2JzZXJ2ZXIub2JzZXJ2ZSh0LmVsKTsKICAgICAgICAgICAgfSkpOwogICAgICAgICAgfQogICAgICAgIH0sIHsKICAgICAgICAgIGtleTogIl9vYnNlcnZlckhhbmRsZXIiLAogICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKGUsIHQpIHsKICAgICAgICAgICAgdmFyIG4gPSB0aGlzOwogICAgICAgICAgICBlLmZvckVhY2goZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICBlLmlzSW50ZXJzZWN0aW5nICYmIG4uTGlzdGVuZXJRdWV1ZS5mb3JFYWNoKGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgICAgICBpZiAodC5lbCA9PT0gZS50YXJnZXQpIHsKICAgICAgICAgICAgICAgICAgaWYgKHQuc3RhdGUubG9hZGVkKSByZXR1cm4gbi5fb2JzZXJ2ZXIudW5vYnNlcnZlKHQuZWwpOwogICAgICAgICAgICAgICAgICB0LmxvYWQoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfSwgewogICAgICAgICAga2V5OiAiX2VsUmVuZGVyZXIiLAogICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKGUsIHQsIG4pIHsKICAgICAgICAgICAgaWYgKGUuZWwpIHsKICAgICAgICAgICAgICB2YXIgciA9IGUuZWwsCiAgICAgICAgICAgICAgICBpID0gZS5iaW5kVHlwZSwKICAgICAgICAgICAgICAgIG8gPSB2b2lkIDA7CiAgICAgICAgICAgICAgc3dpdGNoICh0KSB7CiAgICAgICAgICAgICAgICBjYXNlICJsb2FkaW5nIjoKICAgICAgICAgICAgICAgICAgbyA9IGUubG9hZGluZzsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlICJlcnJvciI6CiAgICAgICAgICAgICAgICAgIG8gPSBlLmVycm9yOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICAgIG8gPSBlLnNyYzsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgaWYgKGkgPyByLnN0eWxlW2ldID0gJ3VybCgiJyArIG8gKyAnIiknIDogci5nZXRBdHRyaWJ1dGUoInNyYyIpICE9PSBvICYmIHIuc2V0QXR0cmlidXRlKCJzcmMiLCBvKSwgci5zZXRBdHRyaWJ1dGUoImxhenkiLCB0KSwgdGhpcy4kZW1pdCh0LCBlLCBuKSwgdGhpcy5vcHRpb25zLmFkYXB0ZXJbdF0gJiYgdGhpcy5vcHRpb25zLmFkYXB0ZXJbdF0oZSwgdGhpcy5vcHRpb25zKSwgdGhpcy5vcHRpb25zLmRpc3BhdGNoRXZlbnQpIHsKICAgICAgICAgICAgICAgIHZhciBhID0gbmV3IGoodCwgewogICAgICAgICAgICAgICAgICBkZXRhaWw6IGUKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgci5kaXNwYXRjaEV2ZW50KGEpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIHsKICAgICAgICAgIGtleTogIl92YWx1ZUZvcm1hdHRlciIsCiAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoZSkgewogICAgICAgICAgICB2YXIgdCA9IGUsCiAgICAgICAgICAgICAgbiA9IHRoaXMub3B0aW9ucy5sb2FkaW5nLAogICAgICAgICAgICAgIHIgPSB0aGlzLm9wdGlvbnMuZXJyb3I7CiAgICAgICAgICAgIHJldHVybiBjKGUpICYmIChlLnNyYyB8fCB0aGlzLm9wdGlvbnMuc2lsZW50IHx8IGNvbnNvbGUuZXJyb3IoIlZ1ZSBMYXp5bG9hZCB3YXJuaW5nOiBtaXNzIHNyYyB3aXRoICIgKyBlKSwgdCA9IGUuc3JjLCBuID0gZS5sb2FkaW5nIHx8IHRoaXMub3B0aW9ucy5sb2FkaW5nLCByID0gZS5lcnJvciB8fCB0aGlzLm9wdGlvbnMuZXJyb3IpLCB7CiAgICAgICAgICAgICAgc3JjOiB0LAogICAgICAgICAgICAgIGxvYWRpbmc6IG4sCiAgICAgICAgICAgICAgZXJyb3I6IHIKICAgICAgICAgICAgfTsKICAgICAgICAgIH0KICAgICAgICB9XSksIHQ7CiAgICAgIH0oKTsKICAgIH0sCiAgICBCID0gZnVuY3Rpb24gQihlKSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgcHJvcHM6IHsKICAgICAgICAgIHRhZzogewogICAgICAgICAgICB0eXBlOiBTdHJpbmcsCiAgICAgICAgICAgIGRlZmF1bHQ6ICJkaXYiCiAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICByZW5kZXI6IGZ1bmN0aW9uIHJlbmRlcihlKSB7CiAgICAgICAgICByZXR1cm4gITEgPT09IHRoaXMuc2hvdyA/IGUodGhpcy50YWcpIDogZSh0aGlzLnRhZywgbnVsbCwgdGhpcy4kc2xvdHMuZGVmYXVsdCk7CiAgICAgICAgfSwKICAgICAgICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgZWw6IG51bGwsCiAgICAgICAgICAgIHN0YXRlOiB7CiAgICAgICAgICAgICAgbG9hZGVkOiAhMQogICAgICAgICAgICB9LAogICAgICAgICAgICByZWN0OiB7fSwKICAgICAgICAgICAgc2hvdzogITEKICAgICAgICAgIH07CiAgICAgICAgfSwKICAgICAgICBtb3VudGVkOiBmdW5jdGlvbiBtb3VudGVkKCkgewogICAgICAgICAgdGhpcy5lbCA9IHRoaXMuJGVsLCBlLmFkZExhenlCb3godGhpcyksIGUubGF6eUxvYWRIYW5kbGVyKCk7CiAgICAgICAgfSwKICAgICAgICBiZWZvcmVEZXN0cm95OiBmdW5jdGlvbiBiZWZvcmVEZXN0cm95KCkgewogICAgICAgICAgZS5yZW1vdmVDb21wb25lbnQodGhpcyk7CiAgICAgICAgfSwKICAgICAgICBtZXRob2RzOiB7CiAgICAgICAgICBnZXRSZWN0OiBmdW5jdGlvbiBnZXRSZWN0KCkgewogICAgICAgICAgICB0aGlzLnJlY3QgPSB0aGlzLiRlbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgICAgICAgIH0sCiAgICAgICAgICBjaGVja0luVmlldzogZnVuY3Rpb24gY2hlY2tJblZpZXcoKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzLmdldFJlY3QoKSwgayAmJiB0aGlzLnJlY3QudG9wIDwgd2luZG93LmlubmVySGVpZ2h0ICogZS5vcHRpb25zLnByZUxvYWQgJiYgdGhpcy5yZWN0LmJvdHRvbSA+IDAgJiYgdGhpcy5yZWN0LmxlZnQgPCB3aW5kb3cuaW5uZXJXaWR0aCAqIGUub3B0aW9ucy5wcmVMb2FkICYmIHRoaXMucmVjdC5yaWdodCA+IDA7CiAgICAgICAgICB9LAogICAgICAgICAgbG9hZDogZnVuY3Rpb24gbG9hZCgpIHsKICAgICAgICAgICAgdGhpcy5zaG93ID0gITAsIHRoaXMuc3RhdGUubG9hZGVkID0gITAsIHRoaXMuJGVtaXQoInNob3ciLCB0aGlzKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH07CiAgICB9LAogICAgViA9IGZ1bmN0aW9uICgpIHsKICAgICAgZnVuY3Rpb24gZSh0KSB7CiAgICAgICAgdmFyIG4gPSB0Lmxhenk7CiAgICAgICAgYih0aGlzLCBlKSwgdGhpcy5sYXp5ID0gbiwgbi5sYXp5Q29udGFpbmVyTWFuYW5nZXIgPSB0aGlzLCB0aGlzLl9xdWV1ZSA9IFtdOwogICAgICB9CiAgICAgIHJldHVybiB5KGUsIFt7CiAgICAgICAga2V5OiAiYmluZCIsCiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKGUsIHQsIG4pIHsKICAgICAgICAgIHZhciByID0gbmV3IE4oewogICAgICAgICAgICBlbDogZSwKICAgICAgICAgICAgYmluZGluZzogdCwKICAgICAgICAgICAgdm5vZGU6IG4sCiAgICAgICAgICAgIGxhenk6IHRoaXMubGF6eQogICAgICAgICAgfSk7CiAgICAgICAgICB0aGlzLl9xdWV1ZS5wdXNoKHIpOwogICAgICAgIH0KICAgICAgfSwgewogICAgICAgIGtleTogInVwZGF0ZSIsCiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKGUsIHQsIG4pIHsKICAgICAgICAgIHZhciByID0gdSh0aGlzLl9xdWV1ZSwgZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICAgcmV0dXJuIHQuZWwgPT09IGU7CiAgICAgICAgICB9KTsKICAgICAgICAgIHIgJiYgci51cGRhdGUoewogICAgICAgICAgICBlbDogZSwKICAgICAgICAgICAgYmluZGluZzogdCwKICAgICAgICAgICAgdm5vZGU6IG4KICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSwgewogICAgICAgIGtleTogInVuYmluZCIsCiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKGUsIHQsIG4pIHsKICAgICAgICAgIHZhciByID0gdSh0aGlzLl9xdWV1ZSwgZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICAgcmV0dXJuIHQuZWwgPT09IGU7CiAgICAgICAgICB9KTsKICAgICAgICAgIHIgJiYgKHIuY2xlYXIoKSwgbyh0aGlzLl9xdWV1ZSwgcikpOwogICAgICAgIH0KICAgICAgfV0pLCBlOwogICAgfSgpLAogICAgTSA9IHsKICAgICAgc2VsZWN0b3I6ICJpbWciCiAgICB9LAogICAgTiA9IGZ1bmN0aW9uICgpIHsKICAgICAgZnVuY3Rpb24gZSh0KSB7CiAgICAgICAgdmFyIG4gPSB0LmVsLAogICAgICAgICAgciA9IHQuYmluZGluZywKICAgICAgICAgIGkgPSB0LnZub2RlLAogICAgICAgICAgbyA9IHQubGF6eTsKICAgICAgICBiKHRoaXMsIGUpLCB0aGlzLmVsID0gbnVsbCwgdGhpcy52bm9kZSA9IGksIHRoaXMuYmluZGluZyA9IHIsIHRoaXMub3B0aW9ucyA9IHt9LCB0aGlzLmxhenkgPSBvLCB0aGlzLl9xdWV1ZSA9IFtdLCB0aGlzLnVwZGF0ZSh7CiAgICAgICAgICBlbDogbiwKICAgICAgICAgIGJpbmRpbmc6IHIKICAgICAgICB9KTsKICAgICAgfQogICAgICByZXR1cm4geShlLCBbewogICAgICAgIGtleTogInVwZGF0ZSIsCiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKGUpIHsKICAgICAgICAgIHZhciB0ID0gdGhpcywKICAgICAgICAgICAgbiA9IGUuZWwsCiAgICAgICAgICAgIHIgPSBlLmJpbmRpbmc7CiAgICAgICAgICB0aGlzLmVsID0gbiwgdGhpcy5vcHRpb25zID0gXyh7fSwgTSwgci52YWx1ZSksIHRoaXMuZ2V0SW1ncygpLmZvckVhY2goZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgdC5sYXp5LmFkZChlLCBfKHt9LCB0LmJpbmRpbmcsIHsKICAgICAgICAgICAgICB2YWx1ZTogewogICAgICAgICAgICAgICAgc3JjOiBlLmRhdGFzZXQuc3JjLAogICAgICAgICAgICAgICAgZXJyb3I6IGUuZGF0YXNldC5lcnJvciwKICAgICAgICAgICAgICAgIGxvYWRpbmc6IGUuZGF0YXNldC5sb2FkaW5nCiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KSwgdC52bm9kZSk7CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0sIHsKICAgICAgICBrZXk6ICJnZXRJbWdzIiwKICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoKSB7CiAgICAgICAgICByZXR1cm4gZih0aGlzLmVsLnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5vcHRpb25zLnNlbGVjdG9yKSk7CiAgICAgICAgfQogICAgICB9LCB7CiAgICAgICAga2V5OiAiY2xlYXIiLAogICAgICAgIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSgpIHsKICAgICAgICAgIHZhciBlID0gdGhpczsKICAgICAgICAgIHRoaXMuZ2V0SW1ncygpLmZvckVhY2goZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICAgcmV0dXJuIGUubGF6eS5yZW1vdmUodCk7CiAgICAgICAgICB9KSwgdGhpcy52bm9kZSA9IG51bGwsIHRoaXMuYmluZGluZyA9IG51bGwsIHRoaXMubGF6eSA9IG51bGw7CiAgICAgICAgfQogICAgICB9XSksIGU7CiAgICB9KCk7CiAgcmV0dXJuIHsKICAgIGluc3RhbGw6IGZ1bmN0aW9uIGluc3RhbGwoZSkgewogICAgICB2YXIgdCA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIHZvaWQgMCAhPT0gYXJndW1lbnRzWzFdID8gYXJndW1lbnRzWzFdIDoge30sCiAgICAgICAgbiA9IEQoZSksCiAgICAgICAgciA9IG5ldyBuKHQpLAogICAgICAgIGkgPSBuZXcgVih7CiAgICAgICAgICBsYXp5OiByCiAgICAgICAgfSksCiAgICAgICAgbyA9ICIyIiA9PT0gZS52ZXJzaW9uLnNwbGl0KCIuIilbMF07CiAgICAgIGUucHJvdG90eXBlLiRMYXp5bG9hZCA9IHIsIHQubGF6eUNvbXBvbmVudCAmJiBlLmNvbXBvbmVudCgibGF6eS1jb21wb25lbnQiLCBCKHIpKSwgbyA/IChlLmRpcmVjdGl2ZSgibGF6eSIsIHsKICAgICAgICBiaW5kOiByLmFkZC5iaW5kKHIpLAogICAgICAgIHVwZGF0ZTogci51cGRhdGUuYmluZChyKSwKICAgICAgICBjb21wb25lbnRVcGRhdGVkOiByLmxhenlMb2FkSGFuZGxlci5iaW5kKHIpLAogICAgICAgIHVuYmluZDogci5yZW1vdmUuYmluZChyKQogICAgICB9KSwgZS5kaXJlY3RpdmUoImxhenktY29udGFpbmVyIiwgewogICAgICAgIGJpbmQ6IGkuYmluZC5iaW5kKGkpLAogICAgICAgIHVwZGF0ZTogaS51cGRhdGUuYmluZChpKSwKICAgICAgICB1bmJpbmQ6IGkudW5iaW5kLmJpbmQoaSkKICAgICAgfSkpIDogKGUuZGlyZWN0aXZlKCJsYXp5IiwgewogICAgICAgIGJpbmQ6IHIubGF6eUxvYWRIYW5kbGVyLmJpbmQociksCiAgICAgICAgdXBkYXRlOiBmdW5jdGlvbiB1cGRhdGUoZSwgdCkgewogICAgICAgICAgXyh0aGlzLnZtLiRyZWZzLCB0aGlzLnZtLiRlbHMpLCByLmFkZCh0aGlzLmVsLCB7CiAgICAgICAgICAgIG1vZGlmaWVyczogdGhpcy5tb2RpZmllcnMgfHwge30sCiAgICAgICAgICAgIGFyZzogdGhpcy5hcmcsCiAgICAgICAgICAgIHZhbHVlOiBlLAogICAgICAgICAgICBvbGRWYWx1ZTogdAogICAgICAgICAgfSwgewogICAgICAgICAgICBjb250ZXh0OiB0aGlzLnZtCiAgICAgICAgICB9KTsKICAgICAgICB9LAogICAgICAgIHVuYmluZDogZnVuY3Rpb24gdW5iaW5kKCkgewogICAgICAgICAgci5yZW1vdmUodGhpcy5lbCk7CiAgICAgICAgfQogICAgICB9KSwgZS5kaXJlY3RpdmUoImxhenktY29udGFpbmVyIiwgewogICAgICAgIHVwZGF0ZTogZnVuY3Rpb24gdXBkYXRlKGUsIHQpIHsKICAgICAgICAgIGkudXBkYXRlKHRoaXMuZWwsIHsKICAgICAgICAgICAgbW9kaWZpZXJzOiB0aGlzLm1vZGlmaWVycyB8fCB7fSwKICAgICAgICAgICAgYXJnOiB0aGlzLmFyZywKICAgICAgICAgICAgdmFsdWU6IGUsCiAgICAgICAgICAgIG9sZFZhbHVlOiB0CiAgICAgICAgICB9LCB7CiAgICAgICAgICAgIGNvbnRleHQ6IHRoaXMudm0KICAgICAgICAgIH0pOwogICAgICAgIH0sCiAgICAgICAgdW5iaW5kOiBmdW5jdGlvbiB1bmJpbmQoKSB7CiAgICAgICAgICBpLnVuYmluZCh0aGlzLmVsKTsKICAgICAgICB9CiAgICAgIH0pKTsKICAgIH0KICB9Owp9KTs="},null]}